# C è¯­è¨€ç¼–è¯‘å™¨å®ç°

[![Language](https://img.shields.io/badge/language-C-blue.svg)]()
[![License](https://img.shields.io/badge/license-MIT-green.svg)]()

ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ C è¯­è¨€å­é›†ç¼–è¯‘å™¨ï¼Œå®ç°äº†ä»æºä»£ç åˆ°ä¸‰åœ°å€ä¸­é—´ä»£ç çš„å®Œæ•´ç¼–è¯‘æµç¨‹ã€‚æ”¯æŒè¯æ³•åˆ†æã€è¯­æ³•åˆ†æã€è¯­ä¹‰åˆ†æå’Œä¸­é—´ä»£ç ç”Ÿæˆï¼Œå…·æœ‰å®Œå–„çš„é”™è¯¯æ£€æµ‹å’ŒæŠ¥å‘Šæœºåˆ¶ã€‚

## ğŸ¯ é¡¹ç›®ç‰¹è‰²

- âœ… **å®Œæ•´çš„ç¼–è¯‘æµç¨‹**: è¯æ³• â†’ è¯­æ³• â†’ è¯­ä¹‰ â†’ ä¸­é—´ä»£ç ç”Ÿæˆ
- âœ… **å¼ºå¤§çš„é”™è¯¯æ£€æµ‹**: æ”¯æŒ 6 ç§è¯­ä¹‰é”™è¯¯ç±»å‹çš„ç²¾ç¡®æ£€æµ‹
- âœ… **æ ‡å‡†ä¸‰åœ°å€ç **: ç”Ÿæˆä¼˜åŒ–å‹å¥½çš„ä¸­é—´è¡¨ç¤º
- âœ… **å…¨é¢æµ‹è¯•è¦†ç›–**: 18 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œ100%é€šè¿‡ç‡
- âœ… **æ¨¡å—åŒ–è®¾è®¡**: æ¸…æ™°çš„æ¶æ„ï¼Œæ˜“äºæ‰©å±•å’Œç»´æŠ¤

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¼–è¯‘å™¨å‰ç«¯å®ç°ï¼ŒåŒ…å«ç¼–è¯‘å™¨çš„å››ä¸ªæ ¸å¿ƒé˜¶æ®µï¼š

- **è¯æ³•åˆ†æ (Lexical Analysis)** - ä½¿ç”¨ Flex ç”Ÿæˆé«˜æ•ˆçš„è¯æ³•åˆ†æå™¨
- **è¯­æ³•åˆ†æ (Syntax Analysis)** - ä½¿ç”¨ Bison ç”Ÿæˆ LALR(1) è¯­æ³•åˆ†æå™¨
- **è¯­ä¹‰åˆ†æ (Semantic Analysis)** - å¤šå±‚ä½œç”¨åŸŸç¬¦å·è¡¨ç®¡ç†å’Œç±»å‹æ£€æŸ¥
- **ä¸­é—´ä»£ç ç”Ÿæˆ (Code Generation)** - ç”Ÿæˆæ ‡å‡†ä¸‰åœ°å€ä¸­é—´ä»£ç 

## âœ¨ æ”¯æŒçš„è¯­è¨€ç‰¹æ€§

### ğŸ”¢ æ•°æ®ç±»å‹

- **åŸºæœ¬ç±»å‹**: `int`ã€`float`
- **å¤åˆç±»å‹**: ä¸€ç»´/å¤šç»´æ•°ç»„ã€ç»“æ„ä½“
- **å‡½æ•°ç±»å‹**: æ”¯æŒå‚æ•°å’Œè¿”å›å€¼çš„å‡½æ•°å®šä¹‰

### ğŸ—ï¸ è¯­è¨€æ„é€ 

- **å˜é‡æ“ä½œ**: å£°æ˜ã€å®šä¹‰ã€èµ‹å€¼
- **å‡½æ•°æœºåˆ¶**: å®šä¹‰ã€è°ƒç”¨ã€å‚æ•°ä¼ é€’ã€è¿”å›å€¼
- **ç®—æœ¯è¿ç®—**: `+`ã€`-`ã€`*`ã€`/`ã€ä¸€å…ƒ`-`
- **å…³ç³»è¿ç®—**: `>`ã€`<`ã€`>=`ã€`<=`ã€`==`ã€`!=`
- **é€»è¾‘è¿ç®—**: `&&`ã€`||`ã€`!`
- **æ§åˆ¶æµ**: `if-else`ã€`while`ã€`return`
- **å¤åˆç»“æ„**: åµŒå¥—æ§åˆ¶æµã€å¤æ‚è¡¨è¾¾å¼

### ğŸ“ è¯­æ³•ç¤ºä¾‹

```c
// å‡½æ•°å®šä¹‰å’Œè°ƒç”¨
int add(int x, int y) {
    return x + y;
}

// åµŒå¥—æ§åˆ¶ç»“æ„
int main() {
    int i = 1, sum = 0;

    while (i <= 10) {
        if (i % 2 == 0) {
            sum = sum + i;
        }
        i = i + 1;
    }

    int result = add(sum, 100);
    return result;
}
```

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

```
ğŸ“¦ ç¼–è¯‘å™¨é¡¹ç›®
â”œâ”€â”€ ğŸ”§ æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ main.c              # ä¸»æ§åˆ¶å™¨å’Œç¼–è¯‘æµç¨‹åè°ƒ
â”‚   â”œâ”€â”€ lexer.l             # Flexè¯æ³•åˆ†æå™¨è§„åˆ™å®šä¹‰
â”‚   â”œâ”€â”€ parser.y            # Bisonè¯­æ³•åˆ†æå™¨è§„åˆ™å®šä¹‰
â”‚   â”œâ”€â”€ tree.h/tree.c       # æŠ½è±¡è¯­æ³•æ ‘æ•°æ®ç»“æ„ä¸æ“ä½œ
â”‚   â”œâ”€â”€ semantic.h/semantic.c # è¯­ä¹‰åˆ†æå™¨å’Œç¬¦å·è¡¨ç®¡ç†
â”‚   â””â”€â”€ codegen.h/codegen.c # ä¸‰åœ°å€ä»£ç ç”Ÿæˆå™¨
â”œâ”€â”€ ğŸ“‹ è§„èŒƒæ–‡æ¡£
â”‚   â”œâ”€â”€ æ–‡æ³•å®šä¹‰.txt         # å®Œæ•´çš„BNFè¯­æ³•è§„èŒƒ
â”‚   â””â”€â”€ Makefile            # è‡ªåŠ¨åŒ–æ„å»ºé…ç½®
â”œâ”€â”€ ğŸ§ª æµ‹è¯•æ¡†æ¶
â”‚   â”œâ”€â”€ tests/              # åŠŸèƒ½æµ‹è¯•ç”¨ä¾‹ (10ä¸ª)
â”‚   â”œâ”€â”€ tests/test_error_*  # é”™è¯¯æ£€æµ‹ç”¨ä¾‹ (8ä¸ª)
â”‚   â”œâ”€â”€ run_tests.bat       # è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬
â”‚   â””â”€â”€ test_results/       # æµ‹è¯•è¾“å‡ºç»“æœ
â””â”€â”€ ğŸ“„ æ–‡æ¡£
    â””â”€â”€ README.md           # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

## ğŸ”§ ç¯å¢ƒè¦æ±‚ä¸æ„å»º

### ç³»ç»Ÿè¦æ±‚

- **ç¼–è¯‘å™¨**: GCC 4.8+ æˆ– Clang 3.5+
- **æ„å»ºå·¥å…·**: GNU Make 3.8+
- **è¯æ³•ç”Ÿæˆå™¨**: Flex 2.5+
- **è¯­æ³•ç”Ÿæˆå™¨**: Bison 3.0+
- **æ“ä½œç³»ç»Ÿ**: Windows 10+ã€Linux

### å¿«é€Ÿå¼€å§‹

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd compiler-project

# 2. æ„å»ºç¼–è¯‘å™¨
make

# 3. è¿è¡Œæµ‹è¯•
./run_tests.bat    # Windows
# æˆ–
chmod +x run_tests.sh && ./run_tests.sh  # Linux/macOS

# 4. ç¼–è¯‘æºæ–‡ä»¶
./parser tests/test_05_functions.c
```

### æ„å»ºé€‰é¡¹

```bash
make              # æ„å»ºç¼–è¯‘å™¨
make clean        # æ¸…ç†æ„å»ºæ–‡ä»¶
```

## ğŸš€ ä½¿ç”¨æŒ‡å—

### åŸºæœ¬ç”¨æ³•

```bash
./parser <source_file.c>
```

### è¾“å‡ºè¯´æ˜

ç¼–è¯‘å™¨ä¼šä¾æ¬¡è¾“å‡ºï¼š

1. **è¯­æ³•æ ‘**: å®Œæ•´çš„æŠ½è±¡è¯­æ³•æ ‘ç»“æ„
2. **ä¸­é—´ä»£ç **: æ ‡å‡†ä¸‰åœ°å€ç æ ¼å¼
3. **æ–‡ä»¶ä¿å­˜**: ä¸­é—´ä»£ç è‡ªåŠ¨ä¿å­˜åˆ° `output.ir`

### ä½¿ç”¨ç¤ºä¾‹

```bash
# ç¼–è¯‘ç®€å•ç¨‹åº
./parser tests/test_01_basic_variables.c

# ç¼–è¯‘å¤æ‚æ§åˆ¶ç»“æ„
./parser tests/test_10_nested_control.c

# æµ‹è¯•é”™è¯¯æ£€æµ‹
./parser tests/test_error_01_undefined_variable.c
```

## ğŸ“Š ä¸‰åœ°å€ä»£ç æ ¼å¼

### æŒ‡ä»¤ç±»å‹

| ç±»åˆ«         | æŒ‡ä»¤æ ¼å¼            | è¯´æ˜       |
| ------------ | ------------------- | ---------- |
| **ç®—æœ¯è¿ç®—** | `t1 := a + b`       | åŠ æ³•è¿ç®—   |
|              | `t2 := a - b`       | å‡æ³•è¿ç®—   |
|              | `t3 := a * b`       | ä¹˜æ³•è¿ç®—   |
|              | `t4 := a / b`       | é™¤æ³•è¿ç®—   |
| **èµ‹å€¼æ“ä½œ** | `x := y`            | å˜é‡èµ‹å€¼   |
|              | `x := #5`           | å¸¸é‡èµ‹å€¼   |
| **å…³ç³»è¿ç®—** | `t1 := a > b`       | å…³ç³»æ¯”è¾ƒ   |
| **æ§åˆ¶æµ**   | `IF t1 GOTO label1` | æ¡ä»¶è·³è½¬   |
|              | `GOTO label2`       | æ— æ¡ä»¶è·³è½¬ |
|              | `label1 :`          | æ ‡ç­¾å®šä¹‰   |
| **å‡½æ•°æ“ä½œ** | `FUNCTION main :`   | å‡½æ•°å¼€å§‹   |
|              | `PARAM x`           | å‚æ•°å£°æ˜   |
|              | `ARG a`             | å‚æ•°ä¼ é€’   |
|              | `t1 := CALL func`   | å‡½æ•°è°ƒç”¨   |
|              | `RETURN x`          | è¿”å›è¯­å¥   |
|              | `END FUNCTION main` | å‡½æ•°ç»“æŸ   |

### ä»£ç ç¤ºä¾‹

**æºä»£ç **:

```c
int main() {
    int a = 5, b = 10;
    if (a < b) {
        return a + b;
    } else {
        return a - b;
    }
}
```

**ç”Ÿæˆçš„ä¸‰åœ°å€ä»£ç **:

```
FUNCTION main :
a := #5
b := #10
t1 := a < b
IF t1 GOTO label1
GOTO label2
label1 :
t2 := a + b
RETURN t2
label2 :
t3 := a - b
RETURN t3
END FUNCTION main
```

## ğŸ§ª æµ‹è¯•æ¡†æ¶

### åŠŸèƒ½æµ‹è¯• (10 ä¸ªæµ‹è¯•ç”¨ä¾‹)

| æµ‹è¯•ç¼–å· | æµ‹è¯•å†…å®¹           | çŠ¶æ€    |
| -------- | ------------------ | ------- |
| test_01  | åŸºæœ¬å˜é‡å£°æ˜å’Œèµ‹å€¼ | âœ… é€šè¿‡ |
| test_02  | ç®—æœ¯è¿ç®—è¡¨è¾¾å¼     | âœ… é€šè¿‡ |
| test_03  | if-else æ¡ä»¶è¯­å¥   | âœ… é€šè¿‡ |
| test_04  | while å¾ªç¯è¯­å¥     | âœ… é€šè¿‡ |
| test_05  | å‡½æ•°å®šä¹‰å’Œè°ƒç”¨     | âœ… é€šè¿‡ |
| test_06  | æ•°ç»„æ“ä½œ           | âœ… é€šè¿‡ |
| test_07  | ç»“æ„ä½“æ“ä½œ         | âœ… é€šè¿‡ |
| test_08  | å¤æ‚è¡¨è¾¾å¼è®¡ç®—     | âœ… é€šè¿‡ |
| test_09  | é€»è¾‘è¿ç®—           | âœ… é€šè¿‡ |
| test_10  | åµŒå¥—æ§åˆ¶ç»“æ„       | âœ… é€šè¿‡ |

### é”™è¯¯æ£€æµ‹æµ‹è¯• (8 ä¸ªæµ‹è¯•ç”¨ä¾‹)

| é”™è¯¯ç±»å‹        | æ£€æµ‹å†…å®¹         | çŠ¶æ€        |
| --------------- | ---------------- | ----------- |
| Error Type 1    | å˜é‡æœªå®šä¹‰ä½¿ç”¨   | âœ… æ£€æµ‹æ­£ç¡® |
| Error Type 2    | å‡½æ•°æœªå®šä¹‰è°ƒç”¨   | âœ… æ£€æµ‹æ­£ç¡® |
| Error Type 3    | å˜é‡é‡å¤å®šä¹‰     | âœ… æ£€æµ‹æ­£ç¡® |
| Error Type 4    | å‡½æ•°é‡å¤å®šä¹‰     | âœ… æ£€æµ‹æ­£ç¡® |
| Error Type 5    | è¿”å›ç±»å‹ä¸åŒ¹é…   | âœ… æ£€æµ‹æ­£ç¡® |
| Error Type 6    | å‡½æ•°è°ƒç”¨å‚æ•°é”™è¯¯ | âœ… æ£€æµ‹æ­£ç¡® |
| Multiple Errors | å¤åˆé”™è¯¯æ£€æµ‹     | âœ… æ£€æµ‹æ­£ç¡® |
| Control Flow    | æ§åˆ¶æµé”™è¯¯       | âœ… æ£€æµ‹æ­£ç¡® |

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
./run_tests.bat

# è¿è¡Œå•ä¸ªæµ‹è¯•
./parser tests/test_05_functions.c

# æŸ¥çœ‹æµ‹è¯•ç»“æœ
ls test_results/
```

## ğŸ“ˆ é¡¹ç›®çŠ¶æ€

### âœ… å·²å®ŒæˆåŠŸèƒ½

- [x] **è¯æ³•åˆ†æ**: å®Œæ•´çš„ token è¯†åˆ«ï¼Œæ”¯æŒæ³¨é‡Šè¿‡æ»¤
- [x] **è¯­æ³•åˆ†æ**: LALR(1)åˆ†æå™¨ï¼Œå®Œæ•´ AST æ„å»º
- [x] **è¯­ä¹‰åˆ†æ**: å¤šå±‚ä½œç”¨åŸŸç¬¦å·è¡¨ï¼Œ6 ç§é”™è¯¯ç±»å‹æ£€æµ‹
- [x] **ä»£ç ç”Ÿæˆ**: æ ‡å‡†ä¸‰åœ°å€ç ï¼Œæ”¯æŒæ‰€æœ‰è¯­è¨€æ„é€ 
- [x] **å‡½æ•°æ”¯æŒ**: å®Œæ•´çš„å‡½æ•°å®šä¹‰ã€è°ƒç”¨ã€å‚æ•°ä¼ é€’
- [x] **æ§åˆ¶æµ**: if-elseã€while çš„å®Œæ•´æ”¯æŒ
- [x] **è¡¨è¾¾å¼**: ç®—æœ¯ã€å…³ç³»ã€é€»è¾‘è¿ç®—çš„å®Œæ•´æ”¯æŒ
- [x] **é”™è¯¯å¤„ç†**: ç²¾ç¡®çš„é”™è¯¯å®šä½å’ŒæŠ¥å‘Š
- [x] **æµ‹è¯•æ¡†æ¶**: 18 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œ100%é€šè¿‡ç‡

### ğŸš§ ä¼˜åŒ–æ–¹å‘

- [ ] **æµ®ç‚¹æ•°è¡¨ç¤º**: æ”¹è¿›ä¸­é—´ä»£ç ä¸­çš„æµ®ç‚¹æ•°æ˜¾ç¤ºæ ¼å¼
- [ ] **æ•°ç»„å¢å¼º**: å¤šç»´æ•°ç»„å’Œæ•°ç»„åˆå§‹åŒ–çš„å®Œæ•´æ”¯æŒ
- [ ] **ç»“æ„ä½“å¢å¼º**: ç»“æ„ä½“åµŒå¥—å’Œå¤æ‚æ“ä½œ
- [ ] **é”™è¯¯æ¢å¤**: è¯­æ³•é”™è¯¯åçš„æ™ºèƒ½æ¢å¤æœºåˆ¶
- [ ] **ä»£ç ä¼˜åŒ–**: åŸºæœ¬å—åˆ†æå’Œæ­»ä»£ç æ¶ˆé™¤
- [ ] **è°ƒè¯•ä¿¡æ¯**: ç”Ÿæˆè°ƒè¯•å™¨å¯ç”¨çš„ç¬¦å·ä¿¡æ¯

### ğŸ”® æœªæ¥è§„åˆ’

- [ ] **åç«¯å¼€å‘**: x86/ARM æ±‡ç¼–ä»£ç ç”Ÿæˆ
- [ ] **ä¼˜åŒ–å™¨**: å¾ªç¯ä¼˜åŒ–ã€å†…è”ä¼˜åŒ–
- [ ] **è¯­è¨€æ‰©å±•**: æŒ‡é’ˆã€å‡½æ•°æŒ‡é’ˆã€é€’å½’ä¼˜åŒ–
- [ ] **å·¥å…·é›†æˆ**: IDE æ’ä»¶ã€è°ƒè¯•å™¨æ”¯æŒ

## ğŸ” æŠ€æœ¯ç»†èŠ‚

### ç¼–è¯‘å™¨æ¶æ„

```
æºä»£ç  (.c) â†’ è¯æ³•åˆ†æ â†’ Tokenæµ â†’ è¯­æ³•åˆ†æ â†’ AST â†’ è¯­ä¹‰åˆ†æ â†’ ç¬¦å·è¡¨ â†’ ä»£ç ç”Ÿæˆ â†’ ä¸‰åœ°å€ç  (.ir)
```

### æ ¸å¿ƒç®—æ³•

- **è¯æ³•åˆ†æ**: åŸºäºæ­£åˆ™è¡¨è¾¾å¼çš„æœ‰é™çŠ¶æ€è‡ªåŠ¨æœº
- **è¯­æ³•åˆ†æ**: LALR(1)ç§»è¿›-å½’çº¦åˆ†æç®—æ³•
- **è¯­ä¹‰åˆ†æ**: é€’å½’ä¸‹é™çš„è¯­ä¹‰æ£€æŸ¥
- **ä»£ç ç”Ÿæˆ**: è¯­æ³•åˆ¶å¯¼çš„ç¿»è¯‘æ–¹æ¡ˆ

### æ€§èƒ½ç‰¹å¾

- **æ—¶é—´å¤æ‚åº¦**: O(n) çº¿æ€§æ—¶é—´ç¼–è¯‘
- **ç©ºé—´å¤æ‚åº¦**: O(n) çº¿æ€§ç©ºé—´ä½¿ç”¨
- **é”™è¯¯æ£€æµ‹**: å•éæ‰«æå¤šé”™è¯¯æ£€æµ‹

## ğŸ“š å­¦ä¹ èµ„æº

### ç›¸å…³æ–‡æ¡£

- `æ–‡æ³•å®šä¹‰.txt` - å®Œæ•´çš„ BNF è¯­æ³•è§„èŒƒ
- `tests/` - ä¸°å¯Œçš„ç¤ºä¾‹ä»£ç 
- `test_results/` - è¯¦ç»†çš„ç¼–è¯‘è¾“å‡ºç¤ºä¾‹

### æ¨èé˜…è¯»

- ã€Šç¼–è¯‘åŸç†ã€‹(é¾™ä¹¦) - ç†è®ºåŸºç¡€
- ã€Šç°ä»£ç¼–è¯‘å™¨å®ç°ã€‹- å®è·µæŒ‡å¯¼
- Flex & Bison å®˜æ–¹æ–‡æ¡£ - å·¥å…·ä½¿ç”¨

---

**æœ€åæ›´æ–°**: 2025 å¹´ 5 æœˆ  
**é¡¹ç›®ç‰ˆæœ¬**: v1.0
